<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	  
<mapper namespace="com.example.project_team.mappers.AccountMapper">

<insert id="insertAccount" parameterType="com.example.project_team.dto.AccountDTO">
	insert into team_account(accountNum,id,accountPw,accountLimit)
	values(TO_CHAR(1002451 || TRUNC(DBMS_RANDOM.VALUE(1, 999999), 0)),#{id},#{accountPW},#{accountLimit})
</insert>

<select id="successAccount" parameterType="String" resultType="com.example.project_team.dto.AccountDTO">
	select * from (select * from team_account order by madedate desc)  where id = #{id} and ROWNUM = 1
</select>

<select id="accountList" parameterType="String" resultType="com.example.project_team.dto.AccountDTO">
	SELECT * FROM team_account where show = 'y' and id=#{id} order by accountType,accountNum
</select>
<select id="accountListE" parameterType="String" resultType="com.example.project_team.dto.AccountDTO">
	SELECT * FROM team_account where show = 'y' and id=#{id} and accountType='e' order by accountNum
</select>
<select id="accountListY" parameterType="String" resultType="com.example.project_team.dto.AccountDTO">
	SELECT * FROM team_account where show = 'y' and id=#{id} and accountType='y' order by accountNum
</select>
<select id="accountListJ" parameterType="String" resultType="com.example.project_team.dto.AccountDTO">
	SELECT * FROM team_account where show = 'y' and id=#{id} and accountType='j' order by accountNum
</select>
<select id="accountListD" parameterType="String" resultType="com.example.project_team.dto.AccountDTO">
	SELECT * FROM team_account where id=#{id} and accountType='d' order by accountNum
</select>


<select id="fetchAccountByNum" parameterType="long" resultType="com.example.project_team.dto.AccountDTO">
	SELECT * FROM team_account WHERE accountNum=#{accountNum} 
</select>

<update id="passwordModify" parameterType="com.example.project_team.dto.AccountDTO">
	UPDATE team_account SET accountPW = #{accountPW} WHERE id=#{id}
</update>

<update id="deleteAccount" parameterType="long">
	UPDATE team_account SET show = 'n' WHERE accountNum=#{accountNum}
</update>

<select id="openAccountData" resultType="com.example.project_team.dto.AccountDTO">
	select COUNT(*) as accountLimit, madedate from team_account group by madedate order by madedate
</select>
<select id="openAccountData2" resultType="com.example.project_team.dto.LoanSignDTO">
	select COUNT(*) as loanNum, loanExecution from team_loan_sign group by loanExecution order by loanExecution
</select>
<select id="openAccountData3" resultType="com.example.project_team.dto.FundAccountDTO">
	select COUNT(*) as FDACCOUNT, madedate from team_fund_account group by madedate order by madedate
</select>

</mapper>